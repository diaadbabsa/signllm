{% extends "videos/base.html" %}
{% block title %}Ø±ÙØ¹ Ø¥Ø´Ø§Ø±Ø©{% endblock %}
{% block nav_upload %}active{% endblock %}

{% block extra_css %}
.form-group { margin-bottom: 24px; }
.form-group label {
    display: block;
    font-weight: 600;
    font-size: 14px;
    color: #444;
    margin-bottom: 8px;
}
.form-group input[type="text"],
.form-group input[type="file"] {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e8e8f0;
    border-radius: 10px;
    font-size: 15px;
    transition: border-color 0.2s;
    font-family: inherit;
}
.form-group input:focus {
    outline: none;
    border-color: #6C63FF;
}
.form-hint {
    font-size: 12px;
    color: #999;
    margin-top: 6px;
}
.upload-area {
    border: 2px dashed #d0d0e0;
    border-radius: 12px;
    padding: 40px;
    text-align: center;
    cursor: pointer;
    transition: border-color 0.2s, background 0.2s;
}
.upload-area:hover { border-color: #6C63FF; background: #f8f8ff; }
.upload-area.has-file { border-color: #4CAF50; background: #f1f8e9; }
.upload-icon { font-size: 40px; opacity: 0.4; }
.form-actions { display: flex; gap: 12px; margin-top: 32px; }
.spinner { display: none; }
.loading .spinner { display: inline-block; }
.loading .btn-text { display: none; }
{% endblock %}

{% block content %}
<div class="card" style="max-width: 600px; margin: 0 auto;">
    <div class="page-header">
        <h2>Ø±ÙØ¹ Ø¥Ø´Ø§Ø±Ø© Ø£ÙØ§ØªØ§Ø± Ø¬Ø¯ÙŠØ¯Ø©</h2>
    </div>

    <form method="post" enctype="multipart/form-data" id="uploadForm">
        {% csrf_token %}

        <div class="form-group">
            <label for="name">Ø§Ø³Ù… Ø§Ù„Ø¥Ø´Ø§Ø±Ø©</label>
            <input type="text" id="name" name="name" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…" required>
            <div class="form-hint">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± ÙƒÙ†ØªÙŠØ¬Ø© Ø¹Ù†Ø¯ Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¥Ø´Ø§Ø±Ø©</div>
        </div>

        <div class="form-group">
            <label>ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø£ÙØ§ØªØ§Ø±</label>
            <div class="upload-area" id="dropArea" onclick="document.getElementById('video').click()">
                <div class="upload-icon">ğŸ¬</div>
                <p id="fileName" style="margin-top:12px; color:#666">Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ Ø£Ùˆ Ø§Ø³Ø­Ø¨Ù‡ Ù‡Ù†Ø§</p>
                <p class="form-hint">MP4, MOV, AVI â€” Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 20 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</p>
            </div>
            <input type="file" id="video" name="video" accept="video/*" style="display:none" required>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary" id="submitBtn" style="flex:1">
                <span class="btn-text">Ø±ÙØ¹ ÙˆØªØ­Ù„ÙŠÙ„ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span>
                <span class="spinner">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù„ÙŠÙ„...</span>
            </button>
            <a href="{% url 'avatar_list' %}" class="btn btn-secondary">Ø¥Ù„ØºØ§Ø¡</a>
        </div>
    </form>
</div>

<script>
const fileInput = document.getElementById('video');
const dropArea = document.getElementById('dropArea');
const fileName = document.getElementById('fileName');
const form = document.getElementById('uploadForm');
const submitBtn = document.getElementById('submitBtn');

fileInput.addEventListener('change', function() {
    if (this.files.length > 0) {
        fileName.textContent = this.files[0].name;
        dropArea.classList.add('has-file');
    }
});

['dragover', 'dragenter'].forEach(e => {
    dropArea.addEventListener(e, function(ev) {
        ev.preventDefault();
        dropArea.style.borderColor = '#6C63FF';
        dropArea.style.background = '#f8f8ff';
    });
});

['dragleave', 'drop'].forEach(e => {
    dropArea.addEventListener(e, function(ev) {
        ev.preventDefault();
        dropArea.style.borderColor = '';
        dropArea.style.background = '';
    });
});

dropArea.addEventListener('drop', function(ev) {
    ev.preventDefault();
    if (ev.dataTransfer.files.length > 0) {
        fileInput.files = ev.dataTransfer.files;
        fileName.textContent = ev.dataTransfer.files[0].name;
        dropArea.classList.add('has-file');
    }
});

form.addEventListener('submit', function() {
    submitBtn.classList.add('loading');
    submitBtn.disabled = true;
});
</script>
{% endblock %}
